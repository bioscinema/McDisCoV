% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/microdiscov.R
\name{differential_abundance}
\alias{differential_abundance}
\title{Full differential‐abundance pipeline with a single grouping variable}
\usage{
differential_abundance(
  physeq,
  group_var,
  imputation = TRUE,
  zero_ratio_threshold = 0.1,
  zero_impute = 0.5,
  Wc = 0.7,
  max_iter = 30,
  tol = 1e-10,
  min_nonzero = 5
)
}
\arguments{
\item{physeq}{A phyloseq object with OTU table, sample_data, and phy_tree}

\item{group_var}{Character; name of a sample_data column (numeric or factor)}

\item{imputation}{Logical; if TRUE, impute zeros, else drop taxa with any zeros}

\item{zero_ratio_threshold}{Numeric; maximum zero ratio for imputation}

\item{zero_impute}{Numeric; value to replace zeros when imputing}

\item{Wc}{Numeric in (0,1); threshold for clustering effect strengths}

\item{max_iter}{Integer; max iterations for the core optimizer}

\item{tol}{Numeric; convergence tolerance}

\item{min_nonzero}{Integer; minimum non-zero counts per group (only for factor group)}
}
\value{
A list with elements:
  * wald_results: data.frame of per-taxon Wald tests
  * group_results: list of taxon groupings by effect size
  * selected_taxa: integer vector of taxa kept after zero-handling
  * core_fit: raw output from run_analysis_core
}
\description{
Full differential‐abundance pipeline with a single grouping variable
}
